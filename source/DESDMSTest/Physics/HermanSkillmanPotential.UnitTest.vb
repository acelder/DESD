Imports DESD


Namespace AtomicPhysics_Tests


    <TestClass> _
Public Class HermanSkillmanPotential_UnitTest

        <TestMethod()> _
        Public Sub GetPotential1()

            Dim P() As Double = {0, 0.0336, 0.0663, 0.0981, 0.1289, 0.1589, 0.188, 0.2163, 0.2438, 0.2704, 0.2963, 0.3457, 0.3922, 0.4359, 0.4768, 0.5153, 0.5512, 0.5849, 0.6163, _
                            0.6456, 0.6729, 0.7218, 0.7638, 0.7995, 0.8296, 0.8545, 0.8749, 0.8911, 0.9036, 0.9128, 0.9191, 0.9239, 0.9203, 0.9101, 0.8949, 0.8759, 0.854, 0.8303, _
                            0.8051, 0.7788, 0.7519, 0.697, 0.6422, 0.5886, 0.537, 0.4881, 0.4422, 0.3995, 0.3599, 0.3235, 0.2902, 0.2322, 0.1846, 0.1461, 0.115, 0.0902, 0.0705, _
                            0.055, 0.0428, 0.0332, 0.0257, 0.0153, 0.0091, 0.0053, 0.0031, 0.0018, 0.0011, 0.0006, 0.0004, 0.0002, 0.0001, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, _
            0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0}

            Dim U() As Double = {1.0, 0.99609, 0.99205, 0.98787, 0.98357, 0.97916, 0.97464, 0.97002, 0.96531, 0.96053, _
                              0.95566, 0.94574, 0.93558, 0.92524, 0.91477, 0.90418, 0.89352, 0.88282, 0.8721, 0.86139, _
                              0.85071, 0.82949, 0.80858, 0.78807, 0.76804, 0.74854, 0.72961, 0.71127, 0.69354, 0.67642, _
                              0.65991, 0.6287, 0.59981, 0.57311, 0.54844, 0.52566, 0.50461, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, _
                              0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, _
                              0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, _
                              0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, 0.5, _
            0.5, 0.5, 0.5}

            Dim EP() As Double = HSTableConverter.ExpandP(P)
            Dim EU() As Double = HSTableConverter.ExpandU(U, Element.Helium)

            Dim mesh As New HermanSkillmanMesh(Element.Helium)

            Dim Orbitals As New List(Of Orbital)

            Orbitals.Add(New Orbital(1, 0, 2.0, 1.0, EP))

            Dim Pot() As Double = HermanSkillmanPotential.GetPotential(mesh, Element.Helium, Orbitals, HermanSkillmanPotential.ExchangeMode.NonStatisticalExchange, True)

            For i As Integer = 1 To mesh.Count - 1

                Assert.AreEqual(EU(i) / mesh.R(i), Pot(i), 0.1)

            Next

        End Sub

        <TestMethod()> _
        Public Sub TestPotential01()

            Dim P10i() As Double = {0.0, 0.0000281, 0.000225099, 0.000759653, 0.0018004, 0.003515579, 0.006072788, 0.00963864, 0.014378332, 0.020455147, 0.028029874, 0.037260166, 0.04829982, 0.061297997, 0.076398381, _
    0.093738276, 0.11344766, 0.135648191, 0.16045217, 0.18796149, 0.218266547, 0.25144516, 0.287561478, 0.326664906, 0.36878906, 0.413950751, 0.462149034, 0.513364311, 0.567557524, _
    0.624669442, 0.684620055, 0.747308097, 0.812610711, 0.880383256, 0.95045929, 1.022650726, 1.096748171, 1.172521465, 1.249720421, 1.328075766, 1.407300304, 1.487090267, 1.567126893, _
    1.647078185, 1.726600874, 1.805342553, 1.882943982, 1.959041534, 2.033269772, 2.105264131, 2.17466368, 2.241113929, 2.304269672, 2.36379781, 2.419380147, 2.470716107, 2.517525358, _
    2.559550294, 2.596558361, 2.628344183, 2.65473148, 2.675574721, 2.690760534, 2.700208806, 2.703873495, 2.70174312, 2.693840932, 2.680224748, 2.660986463, 2.636251233, 2.606176345, _
    2.570949768, 2.530788429, 2.485936209, 2.436661691, 2.383255689, 2.326028585, 2.265307505, 2.201433367, 2.134757845, 2.065640278, 1.994377398, 1.921400082, 1.847072139, 1.771752912, _
    1.69579449, 1.619539105, 1.543316716, 1.467442819, 1.392216496, 1.317918726, 1.244810949, 1.173133913, 1.103106776, 1.034926478, 0.968767374, 0.904781098, 0.84309667, 0.78382082, _
    0.727038503, 0.672813606, 0.621189811, 0.572191611, 0.525825438, 0.482080906, 0.440932125, 0.402339086, 0.366249078, 0.332598136, 0.301312486, 0.272309972, 0.245501463, 0.2207922, _
    0.198083099, 0.177271971, 0.158254673, 0.140926171, 0.125181506, 0.110916668, 0.098029378, 0.086419763, 0.075990943, 0.066649517, 0.058305969, 0.050874974, 0.044275638, 0.038431658, _
    0.033271409, 0.028727982, 0.024739157, 0.021247332, 0.01819942, 0.015546694, 0.013244624, 0.011252681, 0.009534121, 0.008055773, 0.006787801, 0.005703478, 0.004778951, 0.003993014, _
    0.003326886, 0.002763994, 0.002289769, 0.00189145, 0.0015579, 0.001279439, 0.001047678, 0.000855376, 0.000696308, 0.000565137, 0.000457306, 0.000368938, 0.000296749, 0.00023796, _
    0.000190236, 0.000151618, 0.000120467, 0.0000954, 0.0000753, 0.0000593, 0.0000465, 0.0000364, 0.0000284, 0.0000221, 0.0000171, 0.0000132, 0.0000102, 0.00000779, 0.00000596, 0.00000454, 0.00000345, _
    0.00000261, 0.00000197, 0.00000148, 0.00000111, 0.00000083, 0.000000618, 0.000000458, 0.000000339, 0.00000025, 0.000000183, 0.000000134, 0.0000000978, 0.000000071, 0.0000000514, 0.0000000371, 0.0000000266, 0.0000000191, 0.0000000136, _
            0.00000000968, 0.00000000685, 0.00000000484, 0.0000000034, 0.00000000238}

            Dim P20i() As Double = {0, -0.00000756740309613084, -0.0000605361942963157, -0.00020429421075432, -0.00048418356917848, -0.000945448368875644, -0.00163316126700372, _
    -0.00259212922965895, -0.00386677862761554, -0.0055010199261903, -0.00753809231503666, -0.0100203887353413, -0.012989261888437, -0.0164848119506507, -0.0205456568735115, _
    -0.0252086863153152, -0.0305088004283495, -0.0364786349144937, -0.0431482739588698, -0.0505449528549483, -0.0586927523429862, -0.0676122868946126, -0.0773203893872772, _
    -0.087829794820349, -0.0991488259269133, -0.111281083728516, -0.124225146260824, -0.137974278862805, -0.152516159566826, -0.167832623248263, -0.183899428286865, -0.200686049550781, _
    -0.218155501493495, -0.236264195052014, -0.254961832056382, -0.27419134072478, -0.293888855646031, -0.313983745506894, -0.334398691472322, -0.355049818756512, -0.375846883514945, _
    -0.39669351673249, -0.417487526354902, -0.438121258383219, -0.45848201706078, -0.478452543615808, -0.497911552364148, -0.516734322373704, -0.534793342271816, -0.551959005058853, _
    -0.568100349051176, -0.58308584050405, -0.596784192972212, -0.609065217795512, -0.619800699491904, -0.628865289462327, -0.636137411014604, -0.641500168379983, -0.644842252095113, _
    -0.646058832909457, -0.645052436262809, -0.641733789329944, -0.636022632653091, -0.627848488485449, -0.61715137816452, -0.603882481109806, -0.588004728326181, -0.569493323677333, _
    -0.548336186744463, -0.52453431172529, -0.498102037411176, -0.469067223928744, -0.437471332893079, -0.403369408641031, -0.366829959063854, -0.327934735609442, -0.286778413328023, _
    -0.243468173014625, -0.198123188687373, -0.150874024876299, -0.101861949379615, -0.0512381682457062, 0.000837009304326748, 0.0541950683098788, 0.108660238244958, 0.164050487345282, _
    0.2201785523771, 0.276852995522473, 0.333879280551248, 0.391060861210234, 0.448200275170137, 0.50510023759078, 0.561564728074228, 0.617400065356087, 0.672415963082308, 0.726426560678822, _
    0.779251421629459, 0.830716492776159, 0.880655015995582, 0.928908385989811, 0.975326945357137, 1.01977071192288, 1.06211003007607, 1.10222614325947, 1.14001168039488, 1.17537105622854, _
    1.20822077990671, 1.23848967496446, 1.26611900635715, 1.29106252098627, 1.31328639836245, 1.33276912093463, 1.34950126139852, 1.3634851994763, 1.37473476545138, 1.38327482536228, _
    1.38914080441936, 1.39237816567929, 1.39304183942908, 1.39119562216501, 1.38691153881302, 1.38026918841655, 1.37135506476429, 1.36026187349114, 1.34708783469355, 1.3319359936662, _
    1.31491352622298, 1.29613106223299, 1.27570201106141, 1.25374191345985, 1.23036780105099, 1.2056975890496, 1.17984948078348, 1.15294141063779, 1.12509050164512, 1.09641256451194, _
    1.06702160538146, 1.03702939572424, 1.00652202776004, 0.975628280099451, 0.944450850866317, 0.913088739494916, 0.881636955931103, 0.850186278235567, 0.818823027562689, 0.787628891383589, _
    0.756680763373258, 0.726050630964973, 0.695805478548848, 0.666007237286297, 0.636712749404132, 0.607973777655122, 0.579837027734256, 0.552344213824939, 0.525532135116793, _
    0.499432792689172, 0.474073514776028, 0.449477118798507, 0.425662078382588, 0.40264272242221, 0.380429434729188, 0.359028880048256, 0.338444225651964, 0.318675383112177, _
    0.299719240520739, 0.281569908748087, 0.264218953538545, 0.247655636320036, 0.23186713738503, 0.216838783679792, 0.202554256883081, 0.188995803322263, 0.176144423354004, _
    0.16398006087474, 0.152481772407202, 0.141627895381269, 0.131396196734672, 0.121764020220795, 0.112708415076818, 0.104206263135899, 0.0962343885093303, 0.0887696655897341, _
    0.08178911086746, 0.0752699729876977, 0.0691898078687282, 0.0635265520313877, 0.0582585822321129, 0.0533647733239946, 0.0488245436560277, 0.0446178987809553, 0.0407254639313084, _
            0.0371285149400293, 0.0338089991441771, 0.0307495549270445, 0.0279335224381851}

            Dim P21i() As Double = {0, 0.00000000000344839479389073, 0.000000000413216813538907, 0.00000000498689329581497, 0.0000000281100440763216, 0.000000107247832262327, 0.00000032019546633359, 0.000000807220862426615, _
    0.00000179805591930301, 0.00000364365122486547, 0.00000685259204365101, 0.0000121320407152493, 0.0000204330332380392, 0.0000329999164369623, 0.0000514236669343488, 0.0000776987844661817, _
    0.000114283400299261, 0.000164162187067591, 0.000230911599792981, 0.000318766919794889, 0.000432690514314599, 0.000578440665742812, 0.000762640266187868, 0.000992844616668526, _
    0.00127760751644461, 0.00162654477795918, 0.00205039425766198, 0.00256107145376706, 0.00317171968995475, 0.00389675388036766, 0.00475189685718887, 0.00575420723872489, 0.00692209782316467, _
    0.00827534351118447, 0.00983507779613915, 0.0116237769079511, 0.0136652307591862, 0.0159844999228738, 0.0186078579626217, 0.021562718541717, 0.0248775468584851, 0.0285817550891861, _
    0.032705581671358, 0.0372799544218997, 0.042336337654491, 0.0479065636354199, 0.0540226488986693, 0.0607165961337309, 0.0680201825560303, 0.0759647358566699, 0.084580899005188, _
    0.0938983853666762, 0.103945725786796, 0.114750009453344, 0.126336620482461, 0.138728972329859, 0.151948242254872, 0.166013108176376, 0.180939490344066, 0.196740300313433, 0.213425199760324, _
    0.231000371692886, 0.249468306613304, 0.268827606148536, 0.289072806612557, 0.310194224878692, 0.332177828794371, 0.355005134184401, 0.378653130303986, 0.403094235399297, 0.428296283712366, _
    0.454222544855309, 0.480831776171813, 0.508078308397282, 0.535912164375073, 0.564279210047342, 0.593121336612565, 0.622376672282877, 0.65197982158995, 0.681862129821102, 0.71195196988625, _
    0.742175049012265, 0.772454733956839, 0.80271238682182, 0.832867713907286, 0.862839124405335, 0.892544097064931, 0.921899553926247, 0.95082224015037, 0.979229109800778, 1.00703771672357, _
    1.03416661031529, 1.06053573416456, 1.08606682647024, 1.11068381875247, 1.13431323076427, 1.15688455654443, 1.17833063901405, 1.19858802697165, 1.21759731208522, 1.23530343957221, _
    1.25165599136168, 1.2666094357326, 1.28012334393219, 1.29216256814845, 1.30269738333581, 1.31170358790999, 1.31916256786209, 1.32506131956916, 1.32939243784985, 1.33215406452743, _
    1.33334980586937, 1.33298861396218, 1.33108464221263, 1.32765706934689, 1.32272990355756, 1.31633176008454, 1.30849562528813, 1.29925859930324, 1.28866163167635, 1.27674924045336, _
    1.26356923017668, 1.24917239750203, 1.23361224107947, 1.21694466256199, 1.19922767647698, 1.18052111394197, 1.16088633909252, 1.1403859611999, 1.11908356243897, 1.09704342250008, _
    1.07433026129541, 1.0510089791184, 1.02714441671152, 1.00280111294004, 0.978069357981084, 0.952986530254899, 0.927614949016501, 0.902015786784794, 0.87624889245331, 0.850372606071822, _
    0.824443600417374, 0.798516720246991, 0.772644846739754, 0.746878759534464, 0.721267024779545, 0.695855881144454, 0.670689152730622, 0.645808160412924, 0.621251660931648, 0.59705578509095, _
    0.573254004542706, 0.54987709831432, 0.526953148505964, 0.504507536173029, 0.482562966499797, 0.461139494180948, 0.440254577548215, 0.419923132204022, 0.400157611765559, 0.380968086345445, _
    0.362362345400714, 0.344345995686747, 0.32692257999708, 0.31009368784295, 0.293859082913649, 0.278216819323703, 0.263163370922725, 0.248693746882457, 0.234801617355344, 0.221479423860254, _
    0.208718497691482, 0.1965091624488, 0.18484084331404, 0.173702160563687, 0.16308102911558, 0.152964742919145, 0.14334006495858, 0.134193302898042, 0.125510390009584, 0.117276952632819, _
    0.10947838261581, 0.102099897140889, 0.0951266031638144, 0.0885435500366128, 0.0823357863328113, 0.0764884056033608, 0.0709865958896909, 0.0658156788750308, 0.0609611523523392, _
            0.0564087230207881, 0.0521443421722796, 0.0481542323847896, 0.0444249167179093, 0.0409432395949098}

            Dim P30i() As Double = {0, 0.00000220985950278657, 0.0000176779910529109, 0.0000596587094968666, 0.000141392978184271, 0.000276093136792781, 0.000476921458804798, 0.00075696262664735, _
    0.00112919017273452, 0.00160642695770355, 0.00220129978467358, 0.00292618828028645, 0.00379316820948581, 0.00481394943128565, 0.00599980874696557, 0.00736151793994803, 0.00890926735775465, _
    0.0106525854405366, 0.012600254657301, 0.0147602243696203, 0.017139521202754, 0.0197441575651053, 0.0225790390180803, 0.0256478712589449, 0.0289530675383508, 0.0324956573909176, _
    0.036275197610666, 0.0402896864521717, 0.044535482082007, 0.0490072263422808, 0.053697774917775, 0.0585981350181409, 0.0636974116839408, 0.0689827637994683, 0.0744393709060416, _
    0.0800504118747556, 0.0857970564527843, 0.0916584706610478, 0.0976118369254259, 0.103632389722244, 0.109693467406682, 0.11576658076702, 0.121821498729916, 0.127826351494982, 0.133747751211665, _
    0.1395509301234, 0.14519989591797, 0.150657603852424, 0.155886145044443, 0.160846950116184, 0.165501007163066, 0.169809092854054, 0.173732015325734, 0.17723086733491, 0.180267287954186, _
    0.182803730979101, 0.184803738091775, 0.186232214719049, 0.187055706423509, 0.187242673589868, 0.186763762119511, 0.185592067814112, 0.18370339211622, 0.181076486882924, 0.177693285902515, _
    0.173539120919795, 0.168602919993957, 0.162877386098667, 0.156359154008041, 0.149048923672236, 0.140951568431014, 0.132076216579152, 0.122436305054517, 0.112049604295729, 0.10093821354735, _
    0.0891285261826488, 0.0766511649803231, 0.0635408876262623, 0.0498364630516653, 0.035580519575774, 0.020819366165286, 0.00560278844136186, -0.0100161786700956, -0.0259814996640968, _
    -0.0422344061409858, -0.0587136812500778, -0.0753559586577403, -0.0920960339097444, -0.108867186176029, -0.125601508566997, -0.142230245283712, -0.158684134038021, -0.174893752022045, _
    -0.190789863831264, -0.206303769366751, -0.221367649888304, -0.235914909804572, -0.24988051212869, -0.263201304780268, -0.275816335588594, -0.287667153027259, -0.298698090814382, _
    -0.308856533511462, -0.318093161826793, -0.326362175022195, -0.333621489914968, -0.339832914311662, -0.344962295266631, -0.348979640404664, -0.351859213625409, -0.353579603768506, _
    -0.354123768421837, -0.353479051715302, -0.351637179093992, -0.348594227999231, -0.344350578080419, -0.338910839787588, -0.332283765480957, -0.324482141748073, -0.315522667447581, _
    -0.305425815863999, -0.294215685688015, -0.281919838862229, -0.268569130126932, -0.254197525967383, -0.238841917788033, -0.222541926735192, -0.205339704891162, -0.187279730064389, _
    -0.168408598693172, -0.148774814089273, -0.12842857426089, -0.107421556715598, -0.0858067040699411, -0.0636380082949249, -0.040970296849413, -0.0178590190067164, 0.00563996381684963, _
    0.0294705858099478, 0.0535767805500474, 0.077902679853805, 0.102392807234295, 0.126992263687027, 0.151646906890765, 0.176303519687227, 0.200909970758883, 0.225415361329613, _
    0.249770163064703, 0.273926338727663, 0.297837453502896, 0.321458766140927, 0.34474731111228, 0.367661958343723, 0.390163465562424, 0.412214507057242, 0.433779698242465, 0.454825596816742, _
    0.475320704697496, 0.495235448015892, 0.514542164210374, 0.533215069190446, 0.551230238458739, 0.568565570004368, 0.585200767570186, 0.601117306052493, 0.616298422236852, 0.630729085962017, _
    0.644395999908509, 0.657287576182926, 0.66939394342306, 0.680706925731331, 0.691220053457486, 0.700928540255292, 0.709829293297752, 0.717920884175211, 0.725203554799057, 0.731679178900102, _
    0.73735126110062, 0.742224886896976, 0.746306713402837, 0.74960490692583, 0.752129125265537, 0.753890443142794, 0.754901326675249, 0.755175547565566, 0.754728150987748, 0.753575359971095, _
            0.751734538252536, 0.74922408651394, 0.746063401979812, 0.742272768418311, 0.737873314320263, 0.732886898514153, 0.727336068683343, 0.721243944408582}

            Dim P31i() As Double = {0, -0.000000000000815122212189958, -0.0000000000976750700823274, -0.00000000117878831689425, -0.00000000664457600607709, -0.0000000253509518004799, -0.0000000756869360269536, _
    -0.000000190808677673193, -0.000000425019577047212, -0.000000861276372003933, -0.00000161979703682109, -0.00000286773860392939, -0.00000482990418079172, -0.00000780042864150684, -0.0000121553817745561, _
    -0.0000183662161350476, -0.0000270139745708, -0.0000388041594725934, -0.0000545821523629532, -0.000075349058625487, -0.000102277838146519, -0.000136729568569014, -0.000180269673939838, _
    -0.000234683937976918, -0.000301994108220996, -0.000384472885210748, -0.000484658079786998, -0.000605365711959925, -0.000749701816739657, -0.000921072716218625, -0.00112319351328904, _
    -0.00136009456093985, -0.0016361256620853, -0.00195595775836666, -0.00232458187395493, -0.002747305090708, -0.00322974334486509, -0.00377781085367539, -0.00439770600089607, _
    -0.00509589353420662, -0.00587908295511995, -0.00675420301270612, -0.00772837224739327, -0.00880886556843635, -0.0100030768881747, -0.0113184778768379, -0.0127625729441745, _
    -0.014342850599436, -0.0160667313876008, -0.0179415126440599, -0.0199743103522448, -0.022171998433761, -0.0245411458470486, -0.0270879519086287, -0.0298181802856855, -0.032737092146823, _
    -0.0358493789904276, -0.0391590956992184, -0.0426695943927551, -0.0463834596686204, -0.0503024458381645, -0.0544274167721804, -0.0587582889751626, -0.0632939785037781, -0.0680323523368036, _
    -0.072970184789086, -0.078103119532793, -0.083425637750475, -0.0889310329059907, -0.0946113925763057, -0.100457587716258, -0.106459269635923, -0.112604874902012, -0.118881638306297, _
    -0.125275613917132, -0.131771704106642, -0.138353696371986, -0.145004307663712, -0.151705235822615, -0.158437217642321, -0.165180093010482, -0.171912874604499, -0.178613822918024, _
    -0.185260524861364, -0.191829976582108, -0.198298669838794, -0.204642681564946, -0.210837766476726, -0.216859452550322, -0.222683139372243, -0.2282841991864, -0.233638080589188, _
    -0.238720414392531, -0.243507121362295, -0.247974520978937, -0.252099440662917, -0.255859324224865, -0.259232338839961, -0.262197479047053, -0.264734667100824, -0.266824848142316, _
    -0.268450079778216, -0.269593614616592, -0.270239975729398, -0.270375023700639, -0.269986015672076, -0.269061655220288, -0.267592133921728, -0.265569163537661, -0.26298600009546, _
    -0.259837458842462, -0.256119921712834, -0.251831336292137, -0.246971208256398, -0.241540586184203, -0.235542040951867, -0.228979638457099, -0.221858908071336, -0.214186805405949, _
    -0.205971671927644, -0.19722318979236, -0.187952334476723, -0.17817132337571, -0.167893562967766, -0.15713359254909, -0.145907027096548, -0.134230497153604, -0.122121588210608, _
    -0.109598777434648, -0.0966813700751906, -0.0833894334955713, -0.0697437309668579, -0.0557656533820017, -0.041477150752658, -0.0269006620162048, -0.0120590446477699, 0.00302449690832363, _
    0.0183264824695857, 0.0338232279472015, 0.0494909172064597, 0.0653056730192707, 0.0812436275705797, 0.0972809907375369, 0.113394117469636, 0.129559571224819, 0.145754185975966, _
    0.161955122316308, 0.17813992163849, 0.194286552323166, 0.210373453690982, 0.226379569959265, 0.242284382111632, 0.258067928089432, 0.27371082177138, 0.289194259184919, 0.304500025369013, _
    0.31961048819025, 0.334508595845673, 0.349177861873707, 0.363602357842392, 0.377766694491455, 0.39165601501662, 0.405255977614465, 0.418552754486161, 0.431533020074838, 0.444183959236728, _
    0.456493263247484, 0.468449148184468, 0.480040358401854, 0.491256193925347, 0.502086519190533, 0.512521796872316, 0.52255309876716, 0.532172142918238, 0.541371303311115, 0.550143647335993, _
    0.558482941526119, 0.566383687108237, 0.573841119652026, 0.58085124104844, 0.587410811694026, 0.593517378151784, 0.59916925725782, 0.604365559210023, 0.609106163422188, 0.613391737230083, _
            0.617223703716948, 0.620604256492704, 0.623536319911124, 0.626023560604271, 0.628070340771405, 0.629681727275281, 0.630863438715826, 0.631621852927837, 0.631963948621421}


            '// Fill out the zeros in the wave functions:
            Dim P10(649) As Double
            Dim P20(649) As Double
            Dim P21(649) As Double
            Dim P30(649) As Double
            Dim P31(649) As Double

            For i As Integer = 0 To 649
                If i <= 194 Then
                    P10(i) = P10i(i)
                    P20(i) = P20i(i)
                    P21(i) = P21i(i)
                    P30(i) = P30i(i)
                    P31(i) = P31i(i)
                Else
                    P10(i) = 0.0
                    P20(i) = 0.0
                    P21(i) = 0.0
                    P30(i) = 0.0
                    P31(i) = 0.0
                End If
            Next


            Dim mOrbitals As New List(Of Orbital)

            '// For R = 1.058
            '        mOrbitals.Add(New Orbital(1, 0, 1.99986386213126, -134.070303985802, P10))
            '        mOrbitals.Add(New Orbital(2, 0, 2.00019751607878, -11.090374258856, P20))
            '        mOrbitals.Add(New Orbital(2, 1, 6.00173098017042, -7.95401664635916, P21))
            '        mOrbitals.Add(New Orbital(3, 0, 3.79806224890193, -0.997600871818864, P30))
            '        mOrbitals.Add(New Orbital(3, 1, 6.2043793608004, -0.480352909687951, P31))

            '// For R = 1.046
            mOrbitals.Add(New Orbital(1, 0, 1.99986386213126, -134.070303985802, P10))
            mOrbitals.Add(New Orbital(2, 0, 2.00025093118308, -11.090374258856, P20))
            mOrbitals.Add(New Orbital(2, 1, 6.00207002095549, -7.95401664635916, P21))
            mOrbitals.Add(New Orbital(3, 0, 3.91887080969664, -0.997600871818864, P30))
            mOrbitals.Add(New Orbital(3, 1, 6.45158377336615, -0.480352909687951, P31))


            Dim mesh As IRadialMesh = New CubicMesh(0.0, HermanSkillmanMesh.GetCMU(14) * 205.0, 650)
            Dim mIP As Double() = HermanSkillmanPotential.GetPotential(mesh, Element.Silicon, mOrbitals, HermanSkillmanPotential.ExchangeMode.StatisticalExchange, False)

            For i As Integer = 0 To mesh.Count - 1
                Console.WriteLine(mesh.R(i).ToString & ", " & (-mIP(i)).ToString)
            Next

            '// Suspect that charge neutrality isn't working.

        End Sub

    End Class


End Namespace